#========================================================================
#
# Goo library Makefile
#
# Copyright 1996-2003 Glyph & Cog, LLC
#
#========================================================================

# includes basic building rules
# REL_ADDR has to be defined, because Makefile.rules refers 
# to the Makefile.flags
REL_ADDR = ../../../
include $(REL_ADDR)/Makefile.rules

CXX_SRC = \
	GHash.cc \
	GList.cc \
	GString.cc \
	gmem.cc \
	gmempp.cc \
	gfile.cc \
	FixedPoint.cc

C_SRC = \
	parseargs.c
HEADERS = \
	FixedPoint.h\
	GHash.h\
	GList.h\
	GMutex.h\
	GString.h\
	gfile.h\
	gmem.h\
	gtypes.h\
	parseargs.h\
#------------------------------------------------------------------------

all: $(LIBPREFIX)Goo.a

#------------------------------------------------------------------------

GOO_CXX_OBJS = GHash.o GList.o GString.o gmem.o gmempp.o gfile.o FixedPoint.o
GOO_C_OBJS = parseargs.o
GOO_OBJS = $(GOO_CXX_OBJS) $(GOO_C_OBJS)

$(LIBPREFIX)Goo.a: deps $(GOO_OBJS)
	$(DEL_FILE) $(LIBPREFIX)Goo.a
	$(AR) $(LIBPREFIX)Goo.a $(GOO_OBJS)
	$(RANLIB) $(LIBPREFIX)Goo.a

#------------------------------------------------------------------------

clean:
	$(DEL_FILE) $(GOO_OBJS) $(LIBPREFIX)Goo.a deps

#------------------------------------------------------------------------

deps: $(HEADERS)
	$(CXX) $(MANDATORY_INCPATH) -M $(CXX_SRC) > deps
	$(CC) $(MANDATORY_INCPATH) -M $(C_SRC) >> deps

# This requires GNU make (or compatible) because deps file doesn't
# exist in time when invoked for the first time and thus has to
# be generated
include deps
